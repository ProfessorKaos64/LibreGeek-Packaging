#!/usr/bin/make -f
# Modeled after: https://aur.archlinux.org/cgit/aur.git/tree/PKGBUILD?h=gzdoom

export DESTDIR = $(CURDIR)/debian
export PROJECT_BINARY_DIR = debian/gzdoom/usr/games
export ZDOOM_OUTPUT_DIR = debian/gzdoom/usr/lib/gzdoom

%:
	dh $@

override_dh_auto_configure:
	rm -rf build && mkdir build
	cd build && cmake \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_C_FLAGS="$CFLAGS -DSHARE_DIR=\\\"/usr/share/${_name}\\\"" \
		-DCMAKE_CXX_FLAGS="$CXXFLAGS -DSHARE_DIR=\\\"/usr/share/${_name}\\\"" \
	make DESTDIR=$(DESTDIR) -C build -j4
